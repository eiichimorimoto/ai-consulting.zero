# Cloud Vision API 権限設定 - クイックガイド

## 現在のページ
サービスアカウントの一覧ページ（`/iam-admin/serviceaccounts`）にいます。

## 最も簡単な方法（3ステップ）

### ステップ1: Cloud Vision APIを有効化
1. 左側メニューから「**APIとサービス**」→「**ライブラリ**」をクリック
2. 検索ボックスに「**Cloud Vision API**」と入力
3. 「**Cloud Vision API**」をクリック
4. 「**有効にする**」ボタンをクリック
5. 数分待ちます（有効化処理が完了するまで）

### ステップ2: IAMページに移動
1. 左側メニューから「**IAMと管理**」→「**IAM**」をクリック

### ステップ3: サービスアカウントにEditorロールを付与
1. ページ上部の「**プリンシパルを追加**」ボタンをクリック
2. 「新しいプリンシパル」欄に以下を入力：
   ```
   vision-ocr-service-80@aiconsultingzero.iam.gserviceaccount.com
   ```
3. 「ロールを選択」の検索ボックスに「**Editor**」と入力
4. 「**Editor**」を選択
5. 「**保存**」をクリック

**完了！** これでOCR機能が動作するはずです。

---

## 確認方法

1. **5-10分待つ**（権限の反映に時間がかかる場合があります）

2. **開発サーバーを再起動**：
   ```bash
   npm run dev
   ```

3. **名刺画像をアップロードしてテスト**

4. **ターミナルのログを確認**：
   ```
   ✅ Google Cloud Vision API client initialized successfully
   📸 画像をGoogle Cloud Vision APIに送信します...
   ✅ Vision API response received
   ```

---

## 注意事項

- **Editorロール**は広範囲な権限を持ちます
- 開発・テスト環境でのみ使用してください
- 本番環境では、より限定的なロール（Cloud Vision API Clientなど）を使用してください

---

## トラブルシューティング

### エラーが続く場合
1. ブラウザのページをリロード（F5）
2. 5-10分待ってから再度試す
3. 開発サーバーを再起動
4. ブラウザのキャッシュをクリア

### ロールが見つからない場合
- 「Editor」で検索しても見つからない場合は、プロジェクトの権限を確認してください
- プロジェクトのオーナーまたはIAM管理者権限が必要です



