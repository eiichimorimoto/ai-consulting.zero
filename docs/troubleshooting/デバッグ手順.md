# デバッグ手順 - プロファイル作成エラー

## 現在の問題

- ✅ サインアップは成功（ユーザーはSupabaseに作成されている）
- ❌ `/api/create-profile` APIが500エラーを返している
- ⚠️ サーバー側のログがブラウザコンソールに表示されない（ターミナルに出力される）

## デバッグ手順

### 1. サーバー側のログを確認

開発サーバーを起動しているターミナルを確認してください：

```bash
# ターミナルに以下のようなログが表示されているはずです：
🔵 [create-profile API] Request received
🔵 [create-profile API] Supabase client created
🔵 [create-profile API] Request body: ...
```

### 2. Supabaseダッシュボードで確認

1. [Supabaseダッシュボード](https://supabase.com/dashboard)にアクセス
2. プロジェクト「ai^consulting-zero」を選択
3. 「Table Editor」→「profiles」を開く
4. 新規登録したユーザーIDで検索
5. **プロファイルが既に作成されているか確認**

### 3. トリガー関数の動作確認

プロファイルが既に作成されている場合：
- トリガー関数（`handle_new_user()`）が正常に動作している
- APIルートがプロファイルを検出できていない可能性がある

## 解決方法

### オプション1: プロファイル作成APIを呼び出さない（推奨）

トリガー関数でプロファイルが自動的に作成されるため、APIルートを呼び出す必要がない場合があります：

1. サインアップ成功後、3秒待つ
2. プロファイルが存在するか確認（フロントエンド側で）
3. 存在しない場合のみAPIルートを呼び出す

### オプション2: サーバー側のログを確認

ターミナルに表示されるサーバー側のログを確認して、具体的なエラーを特定してください。

## 確認項目

- [ ] サーバー側のターミナルログを確認
- [ ] Supabaseダッシュボードでプロファイルが作成されているか確認
- [ ] ブラウザコンソールのエラーログを確認


