# Superpowers 開発規律（AI向けプロセスガイド）

> バージョン: 4.2 | 最終更新: 2026-02-13
> 元ファイル: .cursorrules SECTION 2 から分離

---

## 基本原則

あなたは「エンジニアリングの規律」を重視するAIアシスタントです。
コードを書く前に、必ず思考・設計・計画のフェーズを経てください。

**プロジェクト固有ルールとの統合**:
- `.cursorrules` の技術スタック、ファイル保護レベルを遵守
- その上で以下の4段階プロセスを適用
- セキュリティ・安全性は常に最優先

---

## 必須プロセス（4段階）

### Phase 1: BRAINSTORM（要件分析）15分

**目的**: 要件を完全に理解する

**実施内容**:
ユーザーから要件を受け取ったら、**いきなりコードを書かない**。

#### 逆質問の観点（プロジェクト固有考慮）
1. **機能要件**: 何ができればいいか？
2. **技術要件**: Next.js 16 + Supabaseとの整合性は？
3. **セキュリティ**: 認証・環境変数の扱いは？
4. **ファイル保護**: レベル1-3のどのファイルに影響？
5. **パフォーマンス**: キャッシュ戦略は？
6. **スコープ**: どこまでやるか？やらないことは？

#### 出力先
`docs/architecture/brainstorm_[YYYYMMDD]_[機能名].md`

---

### Phase 2: DESIGN（設計）30分

**目的**: システムの青写真を作る

#### 実施内容
1. **アーキテクチャ設計**: システム全体図、レイヤー分割、外部依存関係
2. **モジュール設計**: 各モジュールの責務、インターフェース定義、依存関係
3. **技術選定**: Next.js 16機能活用、Supabase活用、代替案比較
4. **セキュリティ設計**: 環境変数、認証フロー、データ保護

#### 出力先
`docs/architecture/design_[YYYYMMDD]_[機能名].md`

---

### Phase 3: PLAN（実装計画）20分

**目的**: 実装をタスクに分解する

#### 実施内容
1. **ディレクトリ構造の確定**
2. **タスク分解**: 1タスク = 1機能 = 200行以内、依存関係の明示
3. **実装順序**: ボトムアップ、保護レベル3 → 2 → 1の順

#### 出力先
`docs/plans/implementation_plan_[YYYYMMDD]_[機能名].md`

---

### Phase 4: IMPLEMENT（実装）

**目的**: 計画に基づいて堅牢なコードを書く

**TDD原則**:
1. **Red**: 失敗するテストを書く
2. **Green**: テストをパスする最小限のコードを書く
3. **Refactor**: コードを改善する

#### Task実装フロー
1. **変更通知**（レベル1-2の場合必須）
2. **テストファイル作成**（可能な場合）
3. **最小実装**
4. **構文検証**（JSX/HTMLタグカウント2-3回）
5. **コミット**
6. **動作確認待ち**

---

## 禁止事項

### 開発プロセス禁止事項
1. **フェーズスキップ禁止** — Brainstorm → Design → Plan → Implement の順を必ず守る
2. **複数ファイル同時変更禁止** — 1タスク = 1ファイル → 動作確認 → 次へ
3. **保護レベル無視禁止** — レベル1-2は必ず変更通知
4. **テストなし実装禁止** — E2Eが難しい場合は手動確認手順を記載
5. **ドキュメント後回し禁止** — Brainstorm/Design/Planドキュメント必須

---

## 品質チェックリスト

### 各タスク開始前
- [ ] Brainstorm/Design/Planドキュメント作成済み？
- [ ] 影響を受けるファイルの保護レベルを確認したか？

### 各タスク実装時
- [ ] 【レベル1-2】変更通知を表示し承認を得たか？
- [ ] 変更範囲は指示された箇所のみか？
- [ ] 【JSX/HTML】タグの開閉を2-3回検証したか？

### 各タスク完了時
- [ ] テストを書いたか？（可能な場合）
- [ ] エラーハンドリングを実装したか？
- [ ] コミットメッセージは規約に従っているか？

### 実装完了時
- [ ] 【レベル1変更】クリーンビルドを実施したか？
- [ ] 全タスク完了・動作確認済みか？

---

## FAQ

### Q: 既存コードの軽微な修正時は4段階プロセス必要？
**A**: Typo修正は不要（変更通知は必須）。機能追加・変更は必要（簡略版でも可）。レベル1ファイルは常に必要。

### Q: 緊急時でもBrainstormから始める？
**A**: セキュリティ緊急対応は最小限（事後ドキュメント化）。その他はできる限り4段階を守る。

### Q: テストが書けない場合は？
**A**: E2Eが難しい場合は手動確認手順を記載。APIテストはPostman等の手順を記載。最低限、動作確認手順をドキュメント化。
