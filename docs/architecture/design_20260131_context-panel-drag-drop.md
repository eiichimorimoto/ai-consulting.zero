# ğŸ¨ Design: ContextPanel ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½è¨­è¨ˆ

**ä½œæˆæ—¥æ™‚**: 2026-01-31
**å‰æãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: brainstorm_20260131_context-panel-drag-drop.md

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ConsultingPage (start/page.tsx)        â”‚
â”‚                                         â”‚
â”‚  - handleFileUpload: (files) => void   â”‚
â”‚  - attachmentFiles: File[]             â”‚
â”‚  - contextData.attachments: Attachment[]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚ Props:
                 â”‚ - onFileUpload
                 â”‚ - attachments
                 â”‚ - onRemoveAttachment
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ContextPanel Component                  â”‚
â”‚ (app/consulting/components/             â”‚
â”‚  ContextPanel.tsx)                      â”‚
â”‚                                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ãƒªã‚¢                    â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚ â”‚ â”‚ <input type="file" hidden>       â”‚â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚ â”‚ â”‚ ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³                     â”‚â”‚â”‚
â”‚ â”‚ â”‚ - onDragOver                      â”‚â”‚â”‚
â”‚ â”‚ â”‚ - onDrop                          â”‚â”‚â”‚
â”‚ â”‚ â”‚ - onDragEnter/Leave               â”‚â”‚â”‚
â”‚ â”‚ â”‚ - onClick (ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ)           â”‚â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚ â”‚ â”‚ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º               â”‚â”‚â”‚
â”‚ â”‚ â”‚ - type: error/warning/info        â”‚â”‚â”‚
â”‚ â”‚ â”‚ - message: string                 â”‚â”‚â”‚
â”‚ â”‚ â”‚ - auto-dismiss: 3-5s              â”‚â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚ â”‚                                      â”‚â”‚
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚ â”‚ â”‚ ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ                     â”‚â”‚â”‚
â”‚ â”‚ â”‚ - file.name                       â”‚â”‚â”‚
â”‚ â”‚ â”‚ - å‰Šé™¤ãƒœã‚¿ãƒ³ (X)                   â”‚â”‚â”‚
â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ

### 1. ContextPanel Componentï¼ˆå¤‰æ›´å¯¾è±¡ï¼‰

**è²¬å‹™**:
- æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«ã®è¡¨ç¤º
- ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å‡¦ç†
- ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
- ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤

**ä¾å­˜**:
- React Hooks: `useState`, `useRef`, `useEffect`, `useCallback`
- Lucide Icons: `FileText`, `X`, `Upload`, `AlertCircle`
- Shadcn/ui: `Card`, `Badge`, `Button`

**Propså®šç¾©**:
```typescript
interface ContextPanelProps {
  // æ—¢å­˜Props
  digitalScore?: number | null
  issueCount?: number
  attachments?: Array<{
    id: string
    name: string
    type: string
  }>
  proposalStatus?: 'none' | 'generating' | 'ready'
  proposalId?: string | null
  industryForecast?: { ... }
  onViewProposal?: () => void
  onDownloadProposal?: () => void
  onRemoveAttachment?: (id: string) => void
  
  // æ–°è¦Props
  onFileUpload?: (files: FileList) => void  // è¿½åŠ 
}
```

**Stateå®šç¾©**:
```typescript
interface ErrorMessage {
  type: 'error' | 'warning' | 'info'
  message: string
  id: string  // è¤‡æ•°ã‚¨ãƒ©ãƒ¼ã®è­˜åˆ¥ç”¨
}

// Componentå†…State
const [isDragging, setIsDragging] = useState(false)
const [errorMessages, setErrorMessages] = useState<ErrorMessage[]>([])
const fileInputRef = useRef<HTMLInputElement>(null)
```

---

### 2. ConsultingPageï¼ˆPropsè¿½åŠ ã®ã¿ï¼‰

**å¤‰æ›´å†…å®¹**:
- `ContextPanel`ã«`onFileUpload={handleFileUpload}`ã‚’è¿½åŠ 

**æ—¢å­˜ã®`handleFileUpload`é–¢æ•°**ï¼ˆå¤‰æ›´ãªã—ï¼‰:
```typescript
const handleFileUpload = useCallback(async (files: FileList) => {
  const fileArray = Array.from(files)
  
  // Fileã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¿å­˜ï¼ˆFormDataé€ä¿¡ç”¨ï¼‰
  setAttachmentFiles(prev => [...prev, ...fileArray])
  
  // UIè¡¨ç¤ºç”¨ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
  const newAttachments = fileArray.map((file, index) => ({
    id: `file-${Date.now()}-${index}`,
    name: file.name,
    type: file.type,
    url: URL.createObjectURL(file),
  }))
  
  setContextData(prev => ({
    ...prev,
    attachments: [...prev.attachments, ...newAttachments],
  }))
}, [])
```

---

## ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

### 1. ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼     â”‚
â”‚ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’   â”‚
â”‚ ãƒ‰ãƒ©ãƒƒã‚°     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onDragEnter/onDragOver      â”‚
â”‚ - preventDefault()          â”‚
â”‚ - setIsDragging(true)       â”‚
â”‚ - è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯       â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onDrop                      â”‚
â”‚ - preventDefault()          â”‚
â”‚ - setIsDragging(false)      â”‚
â”‚ - files = e.dataTransfer.filesâ”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ handleFileValidation()      â”‚
â”‚ - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯     â”‚
â”‚ - MIMEã‚¿ã‚¤ãƒ—ãƒã‚§ãƒƒã‚¯         â”‚
â”‚ - æ‹¡å¼µå­ãƒã‚§ãƒƒã‚¯            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€ OK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚                â”‚
       â”‚                â–¼
       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚ onFileUpload  â”‚
       â”‚         â”‚ (è¦ªã«æ¸¡ã™)    â”‚
       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€ NG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚
                        â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ setErrorMessages  â”‚
                 â”‚ (ã‚¨ãƒ©ãƒ¼è¡¨ç¤º)      â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠï¼ˆã‚¯ãƒªãƒƒã‚¯ï¼‰ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¦ãƒ¼ã‚¶ãƒ¼     â”‚
â”‚ ã‚¯ãƒªãƒƒã‚¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onClick                     â”‚
â”‚ - fileInputRef.current?.click()â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ <input type="file">         â”‚
â”‚ - ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤º   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ onChange                    â”‚
â”‚ - files = e.target.files    â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
ï¼ˆä»¥é™ã€ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã¨åŒã˜ï¼‰
```

### 3. ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ•ãƒ­ãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ setErrorMessages([...])     â”‚
â”‚ - id: unique                â”‚
â”‚ - type: 'error'             â”‚
â”‚ - message: 'xxx'            â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useEffect                   â”‚
â”‚ - setTimeout(5000)          â”‚
â”‚ - è‡ªå‹•å‰Šé™¤                  â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸UIè¡¨ç¤º       â”‚
â”‚ - ã‚¢ã‚¤ã‚³ãƒ³ + ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸      â”‚
â”‚ - ãƒ•ã‚§ãƒ¼ãƒ‰ã‚¤ãƒ³/ã‚¢ã‚¦ãƒˆ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## UI/UXè¨­è¨ˆ

### 1. é€šå¸¸çŠ¶æ…‹ï¼ˆæ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«0ä»¶ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«           0    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                â”‚
â”‚   ğŸ“  ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—       â”‚
â”‚      ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ     â”‚
â”‚                                â”‚
â”‚   å¯¾å¿œå½¢å¼: .txt, .csv, .md,  â”‚
â”‚   .pdf, .doc, .docx, .xls,    â”‚
â”‚   .xlsx, .ppt, .pptx          â”‚
â”‚   æœ€å¤§ã‚µã‚¤ã‚º: 10MB            â”‚
â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ãƒ‰ãƒ©ãƒƒã‚°ã‚ªãƒ¼ãƒãƒ¼çŠ¶æ…‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«           0    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â”â”‚
â”‚ â•  ğŸ“¤  ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—    â•â”‚
â”‚ â•                            â•â”‚
â”‚ â•  èƒŒæ™¯è‰²: é’ã£ã½ã          â•â”‚
â”‚ â”” â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â•Œ â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºçŠ¶æ…‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«           0    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ âš ï¸ ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãŒå¤§ãã™ãã¾ã™â”‚â”‚
â”‚ â”‚    file.pdf (15MB)         â”‚â”‚
â”‚ â”‚    æœ€å¤§ã‚µã‚¤ã‚º: 10MB        â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                â”‚
â”‚   ğŸ“  ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ­ãƒƒãƒ—       â”‚
â”‚      ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ     â”‚
â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. ãƒ•ã‚¡ã‚¤ãƒ«ã‚ã‚ŠçŠ¶æ…‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ æ·»ä»˜ãƒ•ã‚¡ã‚¤ãƒ«           2    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ“„ report.pdf          [X] â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚ ğŸ“„ data.xlsx           [X] â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                â”‚
â”‚   ğŸ“  è¿½åŠ ã§ãƒ‰ãƒ­ãƒƒãƒ—ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ â”‚
â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æŠ€è¡“é¸å®šï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¶ç´„è€ƒæ…®ï¼‰

| ã‚«ãƒ†ã‚´ãƒª | é¸å®šæŠ€è¡“ | ç†ç”± | ä»£æ›¿æ¡ˆ |
|---------|---------|------|--------|
| ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— | Native Drag&Drop API | æ¨™æº–APIã€è»½é‡ | react-dropzoneï¼ˆã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯ï¼‰ |
| ã‚¨ãƒ©ãƒ¼è¡¨ç¤º | React State + Timeout | ã‚·ãƒ³ãƒ—ãƒ«ã€æ—¢å­˜ã‚³ãƒ¼ãƒ‰çµ±ä¸€ | Sonner/Toastï¼ˆè¿½åŠ ä¾å­˜ï¼‰ |
| ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼ | æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯æµç”¨ | ä¸€è²«æ€§ã€ä¿å®ˆæ€§ | æ–°è¦å®Ÿè£…ï¼ˆä¸è¦ï¼‰ |
| ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ | Tailwind CSS | æ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«çµ±ä¸€ | Framer Motionï¼ˆè¿½åŠ ä¾å­˜ï¼‰ |

---

## ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®ç‚¹

1. **ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼**
   - MIMEã‚¿ã‚¤ãƒ—ã¨æ‹¡å¼µå­ã®äºŒé‡ãƒã‚§ãƒƒã‚¯ï¼ˆæ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯æµç”¨ï¼‰
   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™: 10MBï¼ˆæ—¢å­˜ã¨åŒã˜ï¼‰

2. **XSSå¯¾ç­–**
   - ãƒ•ã‚¡ã‚¤ãƒ«åã¯`textContent`ã§è¡¨ç¤ºï¼ˆHTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ï¼‰
   - `URL.createObjectURL`ã¯è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§å‡¦ç†ï¼ˆæ—¢å­˜ï¼‰

3. **CSRFå¯¾ç­–**
   - Supabaseèªè¨¼ã«ã‚ˆã‚‹ä¿è­·ï¼ˆæ—¢å­˜ï¼‰

4. **ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯å¯¾ç­–**
   - `URL.createObjectURL`ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã¯è¦ªãŒè²¬ä»»ï¼ˆæ—¢å­˜ï¼‰
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒãƒ¼ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆ`useEffect`ã®`return`ï¼‰

---

## ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´è¨ˆç”»

### å¤‰æ›´å¯¾è±¡

#### 1. `app/consulting/components/ContextPanel.tsx`
- **å¤‰æ›´å†…å®¹**:
  - Propsè¿½åŠ : `onFileUpload?: (files: FileList) => void`
  - Stateè¿½åŠ : `isDragging`, `errorMessages`
  - Refè¿½åŠ : `fileInputRef`
  - ã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©è¿½åŠ : `handleDragOver`, `handleDrop`, `handleFileChange`, `handleClick`
  - ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼é–¢æ•°è¿½åŠ : `validateFiles`
  - ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºUIè¿½åŠ 
  - ãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³UIè¿½åŠ 

#### 2. `app/consulting/start/page.tsx`
- **å¤‰æ›´å†…å®¹**:
  - `ContextPanel`ã«`onFileUpload={handleFileUpload}`ã‚’è¿½åŠ ï¼ˆ1è¡Œã®ã¿ï¼‰

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**Planï¼ˆå®Ÿè£…è¨ˆç”»ï¼‰ãƒ•ã‚§ãƒ¼ã‚º**ã¸é€²ã‚€
- å®Ÿè£…é †åºã®æ±ºå®š
- ã‚¿ã‚¹ã‚¯ã®åˆ†è§£
- è¦‹ç©ã‚‚ã‚Šæ™‚é–“ã®ç®—å‡º
